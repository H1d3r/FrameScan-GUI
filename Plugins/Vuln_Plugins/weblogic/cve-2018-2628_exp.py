#!/usr/bin/env python
# -*- coding: utf-8 -*-
import sys
import json
import requests
import warnings

def vuln_info():
    info={
        'name': 'CVE-2018-2628',
        'referer':'https://blog.csdn.net/whatday/article/details/107720033',
        'author':'qianxiao996',
        'description':'''CVE-2018-2628为CVE-2017-3248修复版本的绕过，远程攻击者可利用该漏洞在未授权的情况下发送攻击数据，通过T3协议在Weblogic Server中执行反序列化操作，利用RMI（远程方法调用） 机制的缺陷，通过 JRMP 协议达到执行任意反序列化 payload 的目的。CVE-2018-2628原理为在CVE-2017-3248补丁中InboundMsgAbbrev的resolveProxyClass处理rmi接口类型，只判断了java.rmi.registry.Registry，找一个其他的rmi接口即可绕过，比如java.rmi.activation.Activator。''',
    }
    return info

def run(url,heads='',cookie='',cmd='whoami',lhost='',lport=8888):
    #命令执行
    if lhost=='':
        return('root')

    #反弹shell    
    if lhost!='':
        return('反弹成功！')
 



if __name__ == "__main__":
    warnings.filterwarnings("ignore")
    testVuln = run('http://baidu.com','','','whoami')
    te2stVuln = run('http://baidu.com','','','whoami','127.0.0.1',8888)